<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Analysis in Ecology with R and Stan</title>
  <meta name="description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Data Analysis in Ecology with R and Stan" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.jpg" />
  <meta property="og:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="github-repo" content="TobiasRoth/BDAEcology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Analysis in Ecology with R and Stan" />
  
  <meta name="twitter:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="twitter:image" content="images/cover.jpg" />

<meta name="author" content="Fränzi Korner-Nievergelt and Tobias Roth">


<meta name="date" content="2018-10-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="distributions.html">
<link rel="next" href="reproducible.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="Settings/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I R FOR ECOLOGISTS</b></span></li>
<li class="chapter" data-level="1" data-path="PART-I.html"><a href="PART-I.html"><i class="fa fa-check"></i><b>1</b> Introduction to PART I</a><ul>
<li class="chapter" data-level="1.1" data-path="PART-I.html"><a href="PART-I.html#further-reading"><i class="fa fa-check"></i><b>1.1</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Prerequisits: Basic statistical terms</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#scale-of-measurement"><i class="fa fa-check"></i><b>2.1</b> Scale of measurement</a></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#correlations"><i class="fa fa-check"></i><b>2.2</b> Correlations</a><ul>
<li class="chapter" data-level="2.2.1" data-path="basics.html"><a href="basics.html#basics-of-variances-covariances-and-correlations"><i class="fa fa-check"></i><b>2.2.1</b> Basics of variances, covariances and correlations</a></li>
<li class="chapter" data-level="2.2.2" data-path="basics.html"><a href="basics.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>2.2.2</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="2.2.3" data-path="basics.html"><a href="basics.html#spearman-correlation-coefficient"><i class="fa fa-check"></i><b>2.2.3</b> Spearman correlation coefficient</a></li>
<li class="chapter" data-level="2.2.4" data-path="basics.html"><a href="basics.html#kendalls-tau"><i class="fa fa-check"></i><b>2.2.4</b> Kendall’s tau</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#principal-components-analyses-pca"><i class="fa fa-check"></i><b>2.3</b> Principal components analyses PCA</a></li>
<li class="chapter" data-level="2.4" data-path="basics.html"><a href="basics.html#section"><i class="fa fa-check"></i><b>2.4</b> </a></li>
<li class="chapter" data-level="2.5" data-path="basics.html"><a href="basics.html#loadings"><i class="fa fa-check"></i><b>2.5</b> Loadings:</a></li>
<li class="chapter" data-level="2.6" data-path="basics.html"><a href="basics.html#comp.1-comp.2"><i class="fa fa-check"></i><b>2.6</b> Comp.1 Comp.2</a></li>
<li class="chapter" data-level="2.7" data-path="basics.html"><a href="basics.html#x-0.707-0.707"><i class="fa fa-check"></i><b>2.7</b> x 0.707 0.707</a></li>
<li class="chapter" data-level="2.8" data-path="basics.html"><a href="basics.html#y-0.707--0.707"><i class="fa fa-check"></i><b>2.8</b> y 0.707 -0.707</a></li>
<li class="chapter" data-level="2.9" data-path="basics.html"><a href="basics.html#section-1"><i class="fa fa-check"></i><b>2.9</b> </a></li>
<li class="chapter" data-level="2.10" data-path="basics.html"><a href="basics.html#comp.1-comp.2-1"><i class="fa fa-check"></i><b>2.10</b> Comp.1 Comp.2</a></li>
<li class="chapter" data-level="2.11" data-path="basics.html"><a href="basics.html#ss-loadings-1.0-1.0"><i class="fa fa-check"></i><b>2.11</b> SS loadings 1.0 1.0</a></li>
<li class="chapter" data-level="2.12" data-path="basics.html"><a href="basics.html#proportion-var-0.5-0.5"><i class="fa fa-check"></i><b>2.12</b> Proportion Var 0.5 0.5</a></li>
<li class="chapter" data-level="2.13" data-path="basics.html"><a href="basics.html#cumulative-var-0.5-1.0"><i class="fa fa-check"></i><b>2.13</b> Cumulative Var 0.5 1.0</a></li>
<li class="chapter" data-level="2.14" data-path="basics.html"><a href="basics.html#importance-of-components"><i class="fa fa-check"></i><b>2.14</b> Importance of components:</a></li>
<li class="chapter" data-level="2.15" data-path="basics.html"><a href="basics.html#comp.1-comp.2-2"><i class="fa fa-check"></i><b>2.15</b> Comp.1 Comp.2</a></li>
<li class="chapter" data-level="2.16" data-path="basics.html"><a href="basics.html#standard-deviation-1.2564516-0.6490988"><i class="fa fa-check"></i><b>2.16</b> Standard deviation 1.2564516 0.6490988</a></li>
<li class="chapter" data-level="2.17" data-path="basics.html"><a href="basics.html#proportion-of-variance-0.7893354-0.2106646"><i class="fa fa-check"></i><b>2.17</b> Proportion of Variance 0.7893354 0.2106646</a></li>
<li class="chapter" data-level="2.18" data-path="basics.html"><a href="basics.html#cumulative-proportion-0.7893354-1.0000000"><i class="fa fa-check"></i><b>2.18</b> Cumulative Proportion 0.7893354 1.0000000</a><ul>
<li class="chapter" data-level="2.18.1" data-path="basics.html"><a href="basics.html#inferential-statistics"><i class="fa fa-check"></i><b>2.18.1</b> Inferential statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.19" data-path="basics.html"><a href="basics.html#standard-deviation-and-standard-error"><i class="fa fa-check"></i><b>2.19</b> Standard deviation and standard error</a></li>
<li class="chapter" data-level="2.20" data-path="basics.html"><a href="basics.html#central-limit-theorem-law-of-large-numbers"><i class="fa fa-check"></i><b>2.20</b> Central limit theorem / law of large numbers</a></li>
<li class="chapter" data-level="2.21" data-path="basics.html"><a href="basics.html#bayes-theorem"><i class="fa fa-check"></i><b>2.21</b> Bayes theorem</a></li>
<li class="chapter" data-level="2.22" data-path="basics.html"><a href="basics.html#bayes-theorem-for-continuous-parameters"><i class="fa fa-check"></i><b>2.22</b> Bayes theorem for continuous parameters</a></li>
<li class="chapter" data-level="2.23" data-path="basics.html"><a href="basics.html#single-parameter-model"><i class="fa fa-check"></i><b>2.23</b> Single parameter model</a></li>
<li class="chapter" data-level="2.24" data-path="basics.html"><a href="basics.html#a-model-with-two-parameters"><i class="fa fa-check"></i><b>2.24</b> A model with two parameters</a></li>
<li class="chapter" data-level="2.25" data-path="basics.html"><a href="basics.html#t-distribution"><i class="fa fa-check"></i><b>2.25</b> t-distribution</a></li>
<li class="chapter" data-level="2.26" data-path="basics.html"><a href="basics.html#frequentist-one-sample-t-test"><i class="fa fa-check"></i><b>2.26</b> Frequentist one-sample t-test</a></li>
<li class="chapter" data-level="2.27" data-path="basics.html"><a href="basics.html#section-2"><i class="fa fa-check"></i><b>2.27</b> </a></li>
<li class="chapter" data-level="2.28" data-path="basics.html"><a href="basics.html#one-sample-t-test"><i class="fa fa-check"></i><b>2.28</b> One Sample t-test</a></li>
<li class="chapter" data-level="2.29" data-path="basics.html"><a href="basics.html#section-3"><i class="fa fa-check"></i><b>2.29</b> </a></li>
<li class="chapter" data-level="2.30" data-path="basics.html"><a href="basics.html#data-y"><i class="fa fa-check"></i><b>2.30</b> data: y</a></li>
<li class="chapter" data-level="2.31" data-path="basics.html"><a href="basics.html#t-3.0951-df-7-p-value-0.01744"><i class="fa fa-check"></i><b>2.31</b> t = 3.0951, df = 7, p-value = 0.01744</a></li>
<li class="chapter" data-level="2.32" data-path="basics.html"><a href="basics.html#alternative-hypothesis-true-mean-is-not-equal-to-40"><i class="fa fa-check"></i><b>2.32</b> alternative hypothesis: true mean is not equal to 40</a></li>
<li class="chapter" data-level="2.33" data-path="basics.html"><a href="basics.html#percent-confidence-interval"><i class="fa fa-check"></i><b>2.33</b> 95 percent confidence interval:</a></li>
<li class="chapter" data-level="2.34" data-path="basics.html"><a href="basics.html#section-4"><i class="fa fa-check"></i><b>2.34</b> 40.89979 46.72521</a></li>
<li class="chapter" data-level="2.35" data-path="basics.html"><a href="basics.html#sample-estimates"><i class="fa fa-check"></i><b>2.35</b> sample estimates:</a></li>
<li class="chapter" data-level="2.36" data-path="basics.html"><a href="basics.html#mean-of-x"><i class="fa fa-check"></i><b>2.36</b> mean of x</a></li>
<li class="chapter" data-level="2.37" data-path="basics.html"><a href="basics.html#section-5"><i class="fa fa-check"></i><b>2.37</b> 43.8125</a></li>
<li class="chapter" data-level="2.38" data-path="basics.html"><a href="basics.html#nullhypothesis-test"><i class="fa fa-check"></i><b>2.38</b> Nullhypothesis test</a></li>
<li class="chapter" data-level="2.39" data-path="basics.html"><a href="basics.html#confidence-interval"><i class="fa fa-check"></i><b>2.39</b> Confidence interval</a></li>
<li class="chapter" data-level="2.40" data-path="basics.html"><a href="basics.html#posterior-distribution"><i class="fa fa-check"></i><b>2.40</b> Posterior distribution</a></li>
<li class="chapter" data-level="2.41" data-path="basics.html"><a href="basics.html#posterior-probability"><i class="fa fa-check"></i><b>2.41</b> Posterior probability</a></li>
<li class="chapter" data-level="2.42" data-path="basics.html"><a href="basics.html#monte-carlo-simulation-parametric-bootstrap"><i class="fa fa-check"></i><b>2.42</b> Monte Carlo simulation (parametric bootstrap)</a></li>
<li class="chapter" data-level="2.43" data-path="basics.html"><a href="basics.html#methods-for-getting-the-posterior-distribution"><i class="fa fa-check"></i><b>2.43</b> 3 methods for getting the posterior distribution</a></li>
<li class="chapter" data-level="2.44" data-path="basics.html"><a href="basics.html#grid-approximation"><i class="fa fa-check"></i><b>2.44</b> Grid approximation</a></li>
<li class="chapter" data-level="2.45" data-path="basics.html"><a href="basics.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>2.45</b> Monte Carlo simulations</a></li>
<li class="chapter" data-level="2.46" data-path="basics.html"><a href="basics.html#comparison-of-the-locations-between-two-groups"><i class="fa fa-check"></i><b>2.46</b> Comparison of the locations between two groups</a></li>
<li class="chapter" data-level="2.47" data-path="basics.html"><a href="basics.html#difference-between-two-means"><i class="fa fa-check"></i><b>2.47</b> Difference between two means</a></li>
<li class="chapter" data-level="2.48" data-path="basics.html"><a href="basics.html#section-6"><i class="fa fa-check"></i><b>2.48</b> </a></li>
<li class="chapter" data-level="2.49" data-path="basics.html"><a href="basics.html#call"><i class="fa fa-check"></i><b>2.49</b> Call:</a></li>
<li class="chapter" data-level="2.50" data-path="basics.html"><a href="basics.html#lmformula-ell-birthday-data-dat"><i class="fa fa-check"></i><b>2.50</b> lm(formula = ell ~ birthday, data = dat)</a></li>
<li class="chapter" data-level="2.51" data-path="basics.html"><a href="basics.html#section-7"><i class="fa fa-check"></i><b>2.51</b> </a></li>
<li class="chapter" data-level="2.52" data-path="basics.html"><a href="basics.html#coefficients"><i class="fa fa-check"></i><b>2.52</b> Coefficients:</a></li>
<li class="chapter" data-level="2.53" data-path="basics.html"><a href="basics.html#intercept-birthdaywine"><i class="fa fa-check"></i><b>2.53</b> (Intercept) birthdaywine</a></li>
<li class="chapter" data-level="2.54" data-path="basics.html"><a href="basics.html#section-8"><i class="fa fa-check"></i><b>2.54</b> 43.3333 0.6667</a></li>
<li class="chapter" data-level="2.55" data-path="basics.html"><a href="basics.html#section-9"><i class="fa fa-check"></i><b>2.55</b> 2.5% 50% 97.5%</a></li>
<li class="chapter" data-level="2.56" data-path="basics.html"><a href="basics.html#section-10"><i class="fa fa-check"></i><b>2.56</b> -1.6524462 0.6698085 2.9975599</a></li>
<li class="chapter" data-level="2.57" data-path="basics.html"><a href="basics.html#two-sample-t-test"><i class="fa fa-check"></i><b>2.57</b> Two-sample t-test</a></li>
<li class="chapter" data-level="2.58" data-path="basics.html"><a href="basics.html#section-11"><i class="fa fa-check"></i><b>2.58</b> </a></li>
<li class="chapter" data-level="2.59" data-path="basics.html"><a href="basics.html#two-sample-t-test-1"><i class="fa fa-check"></i><b>2.59</b> Two Sample t-test</a></li>
<li class="chapter" data-level="2.60" data-path="basics.html"><a href="basics.html#section-12"><i class="fa fa-check"></i><b>2.60</b> </a></li>
<li class="chapter" data-level="2.61" data-path="basics.html"><a href="basics.html#data-ell-by-birthday"><i class="fa fa-check"></i><b>2.61</b> data: ell by birthday</a></li>
<li class="chapter" data-level="2.62" data-path="basics.html"><a href="basics.html#t--0.63369-df-11-p-value-0.5392"><i class="fa fa-check"></i><b>2.62</b> t = -0.63369, df = 11, p-value = 0.5392</a></li>
<li class="chapter" data-level="2.63" data-path="basics.html"><a href="basics.html#alternative-hypothesis-true-difference-in-means-is-not-equal-to-0"><i class="fa fa-check"></i><b>2.63</b> alternative hypothesis: true difference in means is not equal to 0</a></li>
<li class="chapter" data-level="2.64" data-path="basics.html"><a href="basics.html#percent-confidence-interval-1"><i class="fa fa-check"></i><b>2.64</b> 95 percent confidence interval:</a></li>
<li class="chapter" data-level="2.65" data-path="basics.html"><a href="basics.html#section-13"><i class="fa fa-check"></i><b>2.65</b> -2.982185 1.648851</a></li>
<li class="chapter" data-level="2.66" data-path="basics.html"><a href="basics.html#sample-estimates-1"><i class="fa fa-check"></i><b>2.66</b> sample estimates:</a></li>
<li class="chapter" data-level="2.67" data-path="basics.html"><a href="basics.html#mean-in-group-flowers-mean-in-group-wine"><i class="fa fa-check"></i><b>2.67</b> mean in group flowers mean in group wine</a></li>
<li class="chapter" data-level="2.68" data-path="basics.html"><a href="basics.html#section-14"><i class="fa fa-check"></i><b>2.68</b> 43.33333 44.00000</a></li>
<li class="chapter" data-level="2.69" data-path="basics.html"><a href="basics.html#wilxocon-test"><i class="fa fa-check"></i><b>2.69</b> Wilxocon test</a></li>
<li class="chapter" data-level="2.70" data-path="basics.html"><a href="basics.html#section-15"><i class="fa fa-check"></i><b>2.70</b> </a></li>
<li class="chapter" data-level="2.71" data-path="basics.html"><a href="basics.html#wilcoxon-rank-sum-test-with-continuity-correction"><i class="fa fa-check"></i><b>2.71</b> Wilcoxon rank sum test with continuity correction</a></li>
<li class="chapter" data-level="2.72" data-path="basics.html"><a href="basics.html#section-16"><i class="fa fa-check"></i><b>2.72</b> </a></li>
<li class="chapter" data-level="2.73" data-path="basics.html"><a href="basics.html#data-ell-by-birthday-1"><i class="fa fa-check"></i><b>2.73</b> data: ell by birthday</a></li>
<li class="chapter" data-level="2.74" data-path="basics.html"><a href="basics.html#w-18-p-value-0.7172"><i class="fa fa-check"></i><b>2.74</b> W = 18, p-value = 0.7172</a></li>
<li class="chapter" data-level="2.75" data-path="basics.html"><a href="basics.html#alternative-hypothesis-true-location-shift-is-not-equal-to-0"><i class="fa fa-check"></i><b>2.75</b> alternative hypothesis: true location shift is not equal to 0</a></li>
<li class="chapter" data-level="2.76" data-path="basics.html"><a href="basics.html#randomisation-test"><i class="fa fa-check"></i><b>2.76</b> Randomisation test</a></li>
<li class="chapter" data-level="2.77" data-path="basics.html"><a href="basics.html#section-17"><i class="fa fa-check"></i><b>2.77</b> [1] 0.4898</a></li>
<li class="chapter" data-level="2.78" data-path="basics.html"><a href="basics.html#bootstrap"><i class="fa fa-check"></i><b>2.78</b> Bootstrap</a></li>
<li class="chapter" data-level="2.79" data-path="basics.html"><a href="basics.html#section-18"><i class="fa fa-check"></i><b>2.79</b> 2.5% 97.5%</a></li>
<li class="chapter" data-level="2.80" data-path="basics.html"><a href="basics.html#section-19"><i class="fa fa-check"></i><b>2.80</b> -1.214286 2.725327</a></li>
<li class="chapter" data-level="2.81" data-path="basics.html"><a href="basics.html#f-distribution"><i class="fa fa-check"></i><b>2.81</b> F-distribution</a><ul>
<li class="chapter" data-level="2.81.1" data-path="basics.html"><a href="basics.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>2.81.1</b> Analysis of variance ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="2.82" data-path="basics.html"><a href="basics.html#section-20"><i class="fa fa-check"></i><b>2.82</b> [1] 0.9004</a></li>
<li class="chapter" data-level="2.83" data-path="basics.html"><a href="basics.html#section-21"><i class="fa fa-check"></i><b>2.83</b> [1] 0.953</a></li>
<li class="chapter" data-level="2.84" data-path="basics.html"><a href="basics.html#chisquare-test"><i class="fa fa-check"></i><b>2.84</b> Chisquare test</a></li>
<li class="chapter" data-level="2.85" data-path="basics.html"><a href="basics.html#section-22"><i class="fa fa-check"></i><b>2.85</b> </a></li>
<li class="chapter" data-level="2.86" data-path="basics.html"><a href="basics.html#n-y"><i class="fa fa-check"></i><b>2.86</b> N Y</a></li>
<li class="chapter" data-level="2.87" data-path="basics.html"><a href="basics.html#flowers-5-1"><i class="fa fa-check"></i><b>2.87</b> flowers 5 1</a></li>
<li class="chapter" data-level="2.88" data-path="basics.html"><a href="basics.html#wine-3-4"><i class="fa fa-check"></i><b>2.88</b> wine 3 4</a></li>
<li class="chapter" data-level="2.89" data-path="basics.html"><a href="basics.html#section-23"><i class="fa fa-check"></i><b>2.89</b> </a></li>
<li class="chapter" data-level="2.90" data-path="basics.html"><a href="basics.html#pearsons-chi-squared-test-with-yates-continuity-correction"><i class="fa fa-check"></i><b>2.90</b> Pearson’s Chi-squared test with Yates’ continuity correction</a></li>
<li class="chapter" data-level="2.91" data-path="basics.html"><a href="basics.html#section-24"><i class="fa fa-check"></i><b>2.91</b> </a></li>
<li class="chapter" data-level="2.92" data-path="basics.html"><a href="basics.html#data-tabledatbirthday-datcar"><i class="fa fa-check"></i><b>2.92</b> data: table(dat<span class="math inline">\(birthday, dat\)</span>car)</a></li>
<li class="chapter" data-level="2.93" data-path="basics.html"><a href="basics.html#x-squared-0.85312-df-1-p-value-0.3557"><i class="fa fa-check"></i><b>2.93</b> X-squared = 0.85312, df = 1, p-value = 0.3557</a></li>
<li class="chapter" data-level="2.94" data-path="basics.html"><a href="basics.html#section-25"><i class="fa fa-check"></i><b>2.94</b> </a></li>
<li class="chapter" data-level="2.95" data-path="basics.html"><a href="basics.html#fishers-exact-test-for-count-data"><i class="fa fa-check"></i><b>2.95</b> Fisher’s Exact Test for Count Data</a></li>
<li class="chapter" data-level="2.96" data-path="basics.html"><a href="basics.html#section-26"><i class="fa fa-check"></i><b>2.96</b> </a></li>
<li class="chapter" data-level="2.97" data-path="basics.html"><a href="basics.html#data-tabledatbirthday-datcar-1"><i class="fa fa-check"></i><b>2.97</b> data: table(dat<span class="math inline">\(birthday, dat\)</span>car)</a></li>
<li class="chapter" data-level="2.98" data-path="basics.html"><a href="basics.html#p-value-0.2657"><i class="fa fa-check"></i><b>2.98</b> p-value = 0.2657</a></li>
<li class="chapter" data-level="2.99" data-path="basics.html"><a href="basics.html#alternative-hypothesis-true-odds-ratio-is-not-equal-to-1"><i class="fa fa-check"></i><b>2.99</b> alternative hypothesis: true odds ratio is not equal to 1</a></li>
<li class="chapter" data-level="2.100" data-path="basics.html"><a href="basics.html#percent-confidence-interval-2"><i class="fa fa-check"></i><b>2.100</b> 95 percent confidence interval:</a></li>
<li class="chapter" data-level="2.101" data-path="basics.html"><a href="basics.html#section-27"><i class="fa fa-check"></i><b>2.101</b> 0.3369761 391.2320030</a></li>
<li class="chapter" data-level="2.102" data-path="basics.html"><a href="basics.html#sample-estimates-2"><i class="fa fa-check"></i><b>2.102</b> sample estimates:</a></li>
<li class="chapter" data-level="2.103" data-path="basics.html"><a href="basics.html#odds-ratio"><i class="fa fa-check"></i><b>2.103</b> odds ratio</a></li>
<li class="chapter" data-level="2.104" data-path="basics.html"><a href="basics.html#section-28"><i class="fa fa-check"></i><b>2.104</b> 5.699654</a></li>
<li class="chapter" data-level="2.105" data-path="basics.html"><a href="basics.html#bayesian-way-of-analysing-correlations-between-categorical-variables"><i class="fa fa-check"></i><b>2.105</b> Bayesian way of analysing correlations between categorical variables</a></li>
<li class="chapter" data-level="2.106" data-path="basics.html"><a href="basics.html#section-29"><i class="fa fa-check"></i><b>2.106</b> 2.5% 50% 97.5%</a></li>
<li class="chapter" data-level="2.107" data-path="basics.html"><a href="basics.html#intercept-0.74-1.61-2.47"><i class="fa fa-check"></i><b>2.107</b> (Intercept) 0.74 1.61 2.47</a></li>
<li class="chapter" data-level="2.108" data-path="basics.html"><a href="basics.html#birthdaywine--1.91--0.50-0.90"><i class="fa fa-check"></i><b>2.108</b> birthdaywine -1.91 -0.50 0.90</a></li>
<li class="chapter" data-level="2.109" data-path="basics.html"><a href="basics.html#cary--3.71--1.62-0.52"><i class="fa fa-check"></i><b>2.109</b> carY -3.71 -1.62 0.52</a></li>
<li class="chapter" data-level="2.110" data-path="basics.html"><a href="basics.html#birthdaywinecary--0.67-1.88-4.40"><i class="fa fa-check"></i><b>2.110</b> birthdaywine:carY -0.67 1.88 4.40</a></li>
<li class="chapter" data-level="2.111" data-path="basics.html"><a href="basics.html#summary"><i class="fa fa-check"></i><b>2.111</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyses-steps.html"><a href="analyses-steps.html"><i class="fa fa-check"></i><b>3</b> Data analysis step by step</a><ul>
<li class="chapter" data-level="3.1" data-path="analyses-steps.html"><a href="analyses-steps.html#step1"><i class="fa fa-check"></i><b>3.1</b> Plausibility of Data</a></li>
<li class="chapter" data-level="3.2" data-path="analyses-steps.html"><a href="analyses-steps.html#step2"><i class="fa fa-check"></i><b>3.2</b> Relationships</a></li>
<li class="chapter" data-level="3.3" data-path="analyses-steps.html"><a href="analyses-steps.html#step3"><i class="fa fa-check"></i><b>3.3</b> Error Distribution</a></li>
<li class="chapter" data-level="3.4" data-path="analyses-steps.html"><a href="analyses-steps.html#step4"><i class="fa fa-check"></i><b>3.4</b> Preparation of Explanatory Variables</a></li>
<li class="chapter" data-level="3.5" data-path="analyses-steps.html"><a href="analyses-steps.html#step5"><i class="fa fa-check"></i><b>3.5</b> Data Structure</a></li>
<li class="chapter" data-level="3.6" data-path="analyses-steps.html"><a href="analyses-steps.html#step6"><i class="fa fa-check"></i><b>3.6</b> Fit the Model</a></li>
<li class="chapter" data-level="3.7" data-path="analyses-steps.html"><a href="analyses-steps.html#step7"><i class="fa fa-check"></i><b>3.7</b> Check Model</a></li>
<li class="chapter" data-level="3.8" data-path="analyses-steps.html"><a href="analyses-steps.html#step8"><i class="fa fa-check"></i><b>3.8</b> Model Uncertainty</a></li>
<li class="chapter" data-level="3.9" data-path="analyses-steps.html"><a href="analyses-steps.html#step9"><i class="fa fa-check"></i><b>3.9</b> Draw Conclusions</a></li>
<li class="chapter" data-level="" data-path="analyses-steps.html"><a href="analyses-steps.html#further-reading-1"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datamanip.html"><a href="datamanip.html"><i class="fa fa-check"></i><b>4</b> Data preparation</a><ul>
<li class="chapter" data-level="4.1" data-path="datamanip.html"><a href="datamanip.html#basic-operations"><i class="fa fa-check"></i><b>4.1</b> Basic operations</a></li>
<li class="chapter" data-level="4.2" data-path="datamanip.html"><a href="datamanip.html#further-reading-2"><i class="fa fa-check"></i><b>4.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>5</b> Visualizations</a><ul>
<li class="chapter" data-level="5.1" data-path="figures.html"><a href="figures.html#short-checklist-for-figures"><i class="fa fa-check"></i><b>5.1</b> Short Checklist for figures</a></li>
<li class="chapter" data-level="" data-path="figures.html"><a href="figures.html#further-reading-3"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>6</b> Probability distributions</a><ul>
<li class="chapter" data-level="6.1" data-path="distributions.html"><a href="distributions.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.2</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3" data-path="distributions.html"><a href="distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="6.4" data-path="distributions.html"><a href="distributions.html#gamma-distribution"><i class="fa fa-check"></i><b>6.4</b> Gamma distribution</a><ul>
<li class="chapter" data-level="6.4.1" data-path="distributions.html"><a href="distributions.html#cauchydistri"><i class="fa fa-check"></i><b>6.4.1</b> Cauchy distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rgis.html"><a href="rgis.html"><i class="fa fa-check"></i><b>7</b> Spatial analyses and maps</a><ul>
<li class="chapter" data-level="7.1" data-path="rgis.html"><a href="rgis.html#data-types"><i class="fa fa-check"></i><b>7.1</b> Data types</a><ul>
<li class="chapter" data-level="7.1.1" data-path="rgis.html"><a href="rgis.html#rasterdata"><i class="fa fa-check"></i><b>7.1.1</b> Raster data</a></li>
<li class="chapter" data-level="7.1.2" data-path="rgis.html"><a href="rgis.html#geometrydata"><i class="fa fa-check"></i><b>7.1.2</b> Geometry data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rgis.html"><a href="rgis.html#basic-functions"><i class="fa fa-check"></i><b>7.2</b> Basic functions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="rgis.html"><a href="rgis.html#coordinate-systems"><i class="fa fa-check"></i><b>7.2.1</b> Coordinate systems</a></li>
<li class="chapter" data-level="7.2.2" data-path="rgis.html"><a href="rgis.html#joining-spatial-data"><i class="fa fa-check"></i><b>7.2.2</b> Joining spatial data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="rgis.html"><a href="rgis.html#further-reading-4"><i class="fa fa-check"></i><b>7.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reproducible.html"><a href="reproducible.html"><i class="fa fa-check"></i><b>8</b> Reproducible Research</a><ul>
<li class="chapter" data-level="8.1" data-path="reproducible.html"><a href="reproducible.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="reproducible.html"><a href="reproducible.html#further-reading-5"><i class="fa fa-check"></i><b>8.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="furthertopics.html"><a href="furthertopics.html"><i class="fa fa-check"></i><b>9</b> Further topics</a><ul>
<li class="chapter" data-level="9.1" data-path="furthertopics.html"><a href="furthertopics.html#bioacoustic-analyse"><i class="fa fa-check"></i><b>9.1</b> Bioacoustic analyse</a></li>
<li class="chapter" data-level="9.2" data-path="furthertopics.html"><a href="furthertopics.html#python"><i class="fa fa-check"></i><b>9.2</b> Python</a></li>
</ul></li>
<li class="part"><span><b>II BAYESIAN DATA ANALYSIS</b></span></li>
<li class="chapter" data-level="10" data-path="PART-II.html"><a href="PART-II.html"><i class="fa fa-check"></i><b>10</b> Introduction to PART II</a><ul>
<li class="chapter" data-level="" data-path="PART-II.html"><a href="PART-II.html#further-reading-6"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>11</b> Prior distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="priors.html"><a href="priors.html#introduction-2"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="priors.html"><a href="priors.html#choosepriors"><i class="fa fa-check"></i><b>11.2</b> How to choose a prior</a></li>
<li class="chapter" data-level="11.3" data-path="priors.html"><a href="priors.html#prior-sensitivity"><i class="fa fa-check"></i><b>11.3</b> Prior sensitivity</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>12</b> MCMC using Stan</a><ul>
<li class="chapter" data-level="12.1" data-path="stan.html"><a href="stan.html#background"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="stan.html"><a href="stan.html#install-rstan"><i class="fa fa-check"></i><b>12.2</b> Install <code>rstan</code></a></li>
<li class="chapter" data-level="12.3" data-path="stan.html"><a href="stan.html#firststanmod"><i class="fa fa-check"></i><b>12.3</b> Writing a Stan model</a></li>
<li class="chapter" data-level="12.4" data-path="stan.html"><a href="stan.html#run-stan-from-r"><i class="fa fa-check"></i><b>12.4</b> Run Stan from R</a></li>
<li class="chapter" data-level="12.5" data-path="stan.html"><a href="stan.html#in-file-included-from-cusersfkdocumentsrwin-library3.5bhincludeboostconfig.hpp390"><i class="fa fa-check"></i><b>12.5</b> In file included from C:/Users/fk/Documents/R/win-library/3.5/BH/include/boost/config.hpp:39:0,</a></li>
<li class="chapter" data-level="12.6" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5bhincludeboostmathtoolsconfig.hpp13"><i class="fa fa-check"></i><b>12.6</b> from C:/Users/fk/Documents/R/win-library/3.5/BH/include/boost/math/tools/config.hpp:13,</a></li>
<li class="chapter" data-level="12.7" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludestanmathrevcorevar.hpp7"><i class="fa fa-check"></i><b>12.7</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/stan/math/rev/core/var.hpp:7,</a></li>
<li class="chapter" data-level="12.8" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludestanmathrevcoregevv_vvv_vari.hpp5"><i class="fa fa-check"></i><b>12.8</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/stan/math/rev/core/gevv_vvv_vari.hpp:5,</a></li>
<li class="chapter" data-level="12.9" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludestanmathrevcore.hpp12"><i class="fa fa-check"></i><b>12.9</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/stan/math/rev/core.hpp:12,</a></li>
<li class="chapter" data-level="12.10" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludestanmathrevmat.hpp4"><i class="fa fa-check"></i><b>12.10</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/stan/math/rev/mat.hpp:4,</a></li>
<li class="chapter" data-level="12.11" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludestanmath.hpp4"><i class="fa fa-check"></i><b>12.11</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/stan/math.hpp:4,</a></li>
<li class="chapter" data-level="12.12" data-path="stan.html"><a href="stan.html#from-cusersfkdocumentsrwin-library3.5stanheadersincludesrcstanmodelmodel_header.hpp4"><i class="fa fa-check"></i><b>12.12</b> from C:/Users/fk/Documents/R/win-library/3.5/StanHeaders/include/src/stan/model/model_header.hpp:4,</a></li>
<li class="chapter" data-level="12.13" data-path="stan.html"><a href="stan.html#from-filee2856303bb1.cpp8"><i class="fa fa-check"></i><b>12.13</b> from filee2856303bb1.cpp:8:</a></li>
<li class="chapter" data-level="12.14" data-path="stan.html"><a href="stan.html#cusersfkdocumentsrwin-library3.5bhincludeboostconfigcompilergcc.hpp1860-warning-boost_no_cxx11_rvalue_references-redefined"><i class="fa fa-check"></i><b>12.14</b> C:/Users/fk/Documents/R/win-library/3.5/BH/include/boost/config/compiler/gcc.hpp:186:0: warning: “BOOST_NO_CXX11_RVALUE_REFERENCES” redefined</a></li>
<li class="chapter" data-level="12.15" data-path="stan.html"><a href="stan.html#define-boost_no_cxx11_rvalue_references"><i class="fa fa-check"></i><b>12.15</b> # define BOOST_NO_CXX11_RVALUE_REFERENCES</a></li>
<li class="chapter" data-level="12.16" data-path="stan.html"><a href="stan.html#section-30"><i class="fa fa-check"></i><b>12.16</b> ^</a></li>
<li class="chapter" data-level="12.17" data-path="stan.html"><a href="stan.html#note-this-is-the-location-of-the-previous-definition"><i class="fa fa-check"></i><b>12.17</b> <command-line>:0:0: note: this is the location of the previous definition</a></li>
<li class="chapter" data-level="12.18" data-path="stan.html"><a href="stan.html#cc1plus.exe-warning-unrecognized-command-line-option--wno-ignored-attributes"><i class="fa fa-check"></i><b>12.18</b> cc1plus.exe: warning: unrecognized command line option “-Wno-ignored-attributes”</a></li>
<li class="chapter" data-level="12.19" data-path="stan.html"><a href="stan.html#section-31"><i class="fa fa-check"></i><b>12.19</b> </a></li>
<li class="chapter" data-level="12.20" data-path="stan.html"><a href="stan.html#sampling-for-model-linreg-now-chain-1."><i class="fa fa-check"></i><b>12.20</b> SAMPLING FOR MODEL ‘linreg’ NOW (CHAIN 1).</a></li>
<li class="chapter" data-level="12.21" data-path="stan.html"><a href="stan.html#section-32"><i class="fa fa-check"></i><b>12.21</b> </a></li>
<li class="chapter" data-level="12.22" data-path="stan.html"><a href="stan.html#gradient-evaluation-took-0-seconds"><i class="fa fa-check"></i><b>12.22</b> Gradient evaluation took 0 seconds</a></li>
<li class="chapter" data-level="12.23" data-path="stan.html"><a href="stan.html#transitions-using-10-leapfrog-steps-per-transition-would-take-0-seconds."><i class="fa fa-check"></i><b>12.23</b> 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</a></li>
<li class="chapter" data-level="12.24" data-path="stan.html"><a href="stan.html#adjust-your-expectations-accordingly"><i class="fa fa-check"></i><b>12.24</b> Adjust your expectations accordingly!</a></li>
<li class="chapter" data-level="12.25" data-path="stan.html"><a href="stan.html#section-33"><i class="fa fa-check"></i><b>12.25</b> </a></li>
<li class="chapter" data-level="12.26" data-path="stan.html"><a href="stan.html#section-34"><i class="fa fa-check"></i><b>12.26</b> </a></li>
<li class="chapter" data-level="12.27" data-path="stan.html"><a href="stan.html#iteration-1-2000-0-warmup"><i class="fa fa-check"></i><b>12.27</b> Iteration: 1 / 2000 [ 0%] (Warmup)</a></li>
<li class="chapter" data-level="12.28" data-path="stan.html"><a href="stan.html#iteration-200-2000-10-warmup"><i class="fa fa-check"></i><b>12.28</b> Iteration: 200 / 2000 [ 10%] (Warmup)</a></li>
<li class="chapter" data-level="12.29" data-path="stan.html"><a href="stan.html#iteration-400-2000-20-warmup"><i class="fa fa-check"></i><b>12.29</b> Iteration: 400 / 2000 [ 20%] (Warmup)</a></li>
<li class="chapter" data-level="12.30" data-path="stan.html"><a href="stan.html#iteration-600-2000-30-warmup"><i class="fa fa-check"></i><b>12.30</b> Iteration: 600 / 2000 [ 30%] (Warmup)</a></li>
<li class="chapter" data-level="12.31" data-path="stan.html"><a href="stan.html#iteration-800-2000-40-warmup"><i class="fa fa-check"></i><b>12.31</b> Iteration: 800 / 2000 [ 40%] (Warmup)</a></li>
<li class="chapter" data-level="12.32" data-path="stan.html"><a href="stan.html#iteration-1000-2000-50-warmup"><i class="fa fa-check"></i><b>12.32</b> Iteration: 1000 / 2000 [ 50%] (Warmup)</a></li>
<li class="chapter" data-level="12.33" data-path="stan.html"><a href="stan.html#iteration-1001-2000-50-sampling"><i class="fa fa-check"></i><b>12.33</b> Iteration: 1001 / 2000 [ 50%] (Sampling)</a></li>
<li class="chapter" data-level="12.34" data-path="stan.html"><a href="stan.html#iteration-1200-2000-60-sampling"><i class="fa fa-check"></i><b>12.34</b> Iteration: 1200 / 2000 [ 60%] (Sampling)</a></li>
<li class="chapter" data-level="12.35" data-path="stan.html"><a href="stan.html#iteration-1400-2000-70-sampling"><i class="fa fa-check"></i><b>12.35</b> Iteration: 1400 / 2000 [ 70%] (Sampling)</a></li>
<li class="chapter" data-level="12.36" data-path="stan.html"><a href="stan.html#iteration-1600-2000-80-sampling"><i class="fa fa-check"></i><b>12.36</b> Iteration: 1600 / 2000 [ 80%] (Sampling)</a></li>
<li class="chapter" data-level="12.37" data-path="stan.html"><a href="stan.html#iteration-1800-2000-90-sampling"><i class="fa fa-check"></i><b>12.37</b> Iteration: 1800 / 2000 [ 90%] (Sampling)</a></li>
<li class="chapter" data-level="12.38" data-path="stan.html"><a href="stan.html#iteration-2000-2000-100-sampling"><i class="fa fa-check"></i><b>12.38</b> Iteration: 2000 / 2000 [100%] (Sampling)</a></li>
<li class="chapter" data-level="12.39" data-path="stan.html"><a href="stan.html#section-35"><i class="fa fa-check"></i><b>12.39</b> </a></li>
<li class="chapter" data-level="12.40" data-path="stan.html"><a href="stan.html#elapsed-time-0.08-seconds-warm-up"><i class="fa fa-check"></i><b>12.40</b> Elapsed Time: 0.08 seconds (Warm-up)</a></li>
<li class="chapter" data-level="12.41" data-path="stan.html"><a href="stan.html#seconds-sampling"><i class="fa fa-check"></i><b>12.41</b> 0.057 seconds (Sampling)</a></li>
<li class="chapter" data-level="12.42" data-path="stan.html"><a href="stan.html#seconds-total"><i class="fa fa-check"></i><b>12.42</b> 0.137 seconds (Total)</a></li>
<li class="chapter" data-level="12.43" data-path="stan.html"><a href="stan.html#section-36"><i class="fa fa-check"></i><b>12.43</b> </a></li>
<li class="chapter" data-level="12.44" data-path="stan.html"><a href="stan.html#section-37"><i class="fa fa-check"></i><b>12.44</b> </a></li>
<li class="chapter" data-level="12.45" data-path="stan.html"><a href="stan.html#sampling-for-model-linreg-now-chain-2."><i class="fa fa-check"></i><b>12.45</b> SAMPLING FOR MODEL ‘linreg’ NOW (CHAIN 2).</a></li>
<li class="chapter" data-level="12.46" data-path="stan.html"><a href="stan.html#section-38"><i class="fa fa-check"></i><b>12.46</b> </a></li>
<li class="chapter" data-level="12.47" data-path="stan.html"><a href="stan.html#gradient-evaluation-took-0-seconds-1"><i class="fa fa-check"></i><b>12.47</b> Gradient evaluation took 0 seconds</a></li>
<li class="chapter" data-level="12.48" data-path="stan.html"><a href="stan.html#transitions-using-10-leapfrog-steps-per-transition-would-take-0-seconds.-1"><i class="fa fa-check"></i><b>12.48</b> 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</a></li>
<li class="chapter" data-level="12.49" data-path="stan.html"><a href="stan.html#adjust-your-expectations-accordingly-1"><i class="fa fa-check"></i><b>12.49</b> Adjust your expectations accordingly!</a></li>
<li class="chapter" data-level="12.50" data-path="stan.html"><a href="stan.html#section-39"><i class="fa fa-check"></i><b>12.50</b> </a></li>
<li class="chapter" data-level="12.51" data-path="stan.html"><a href="stan.html#section-40"><i class="fa fa-check"></i><b>12.51</b> </a></li>
<li class="chapter" data-level="12.52" data-path="stan.html"><a href="stan.html#iteration-1-2000-0-warmup-1"><i class="fa fa-check"></i><b>12.52</b> Iteration: 1 / 2000 [ 0%] (Warmup)</a></li>
<li class="chapter" data-level="12.53" data-path="stan.html"><a href="stan.html#iteration-200-2000-10-warmup-1"><i class="fa fa-check"></i><b>12.53</b> Iteration: 200 / 2000 [ 10%] (Warmup)</a></li>
<li class="chapter" data-level="12.54" data-path="stan.html"><a href="stan.html#iteration-400-2000-20-warmup-1"><i class="fa fa-check"></i><b>12.54</b> Iteration: 400 / 2000 [ 20%] (Warmup)</a></li>
<li class="chapter" data-level="12.55" data-path="stan.html"><a href="stan.html#iteration-600-2000-30-warmup-1"><i class="fa fa-check"></i><b>12.55</b> Iteration: 600 / 2000 [ 30%] (Warmup)</a></li>
<li class="chapter" data-level="12.56" data-path="stan.html"><a href="stan.html#iteration-800-2000-40-warmup-1"><i class="fa fa-check"></i><b>12.56</b> Iteration: 800 / 2000 [ 40%] (Warmup)</a></li>
<li class="chapter" data-level="12.57" data-path="stan.html"><a href="stan.html#iteration-1000-2000-50-warmup-1"><i class="fa fa-check"></i><b>12.57</b> Iteration: 1000 / 2000 [ 50%] (Warmup)</a></li>
<li class="chapter" data-level="12.58" data-path="stan.html"><a href="stan.html#iteration-1001-2000-50-sampling-1"><i class="fa fa-check"></i><b>12.58</b> Iteration: 1001 / 2000 [ 50%] (Sampling)</a></li>
<li class="chapter" data-level="12.59" data-path="stan.html"><a href="stan.html#iteration-1200-2000-60-sampling-1"><i class="fa fa-check"></i><b>12.59</b> Iteration: 1200 / 2000 [ 60%] (Sampling)</a></li>
<li class="chapter" data-level="12.60" data-path="stan.html"><a href="stan.html#iteration-1400-2000-70-sampling-1"><i class="fa fa-check"></i><b>12.60</b> Iteration: 1400 / 2000 [ 70%] (Sampling)</a></li>
<li class="chapter" data-level="12.61" data-path="stan.html"><a href="stan.html#iteration-1600-2000-80-sampling-1"><i class="fa fa-check"></i><b>12.61</b> Iteration: 1600 / 2000 [ 80%] (Sampling)</a></li>
<li class="chapter" data-level="12.62" data-path="stan.html"><a href="stan.html#iteration-1800-2000-90-sampling-1"><i class="fa fa-check"></i><b>12.62</b> Iteration: 1800 / 2000 [ 90%] (Sampling)</a></li>
<li class="chapter" data-level="12.63" data-path="stan.html"><a href="stan.html#iteration-2000-2000-100-sampling-1"><i class="fa fa-check"></i><b>12.63</b> Iteration: 2000 / 2000 [100%] (Sampling)</a></li>
<li class="chapter" data-level="12.64" data-path="stan.html"><a href="stan.html#section-41"><i class="fa fa-check"></i><b>12.64</b> </a></li>
<li class="chapter" data-level="12.65" data-path="stan.html"><a href="stan.html#elapsed-time-0.078-seconds-warm-up"><i class="fa fa-check"></i><b>12.65</b> Elapsed Time: 0.078 seconds (Warm-up)</a></li>
<li class="chapter" data-level="12.66" data-path="stan.html"><a href="stan.html#seconds-sampling-1"><i class="fa fa-check"></i><b>12.66</b> 0.059 seconds (Sampling)</a></li>
<li class="chapter" data-level="12.67" data-path="stan.html"><a href="stan.html#seconds-total-1"><i class="fa fa-check"></i><b>12.67</b> 0.137 seconds (Total)</a></li>
<li class="chapter" data-level="12.68" data-path="stan.html"><a href="stan.html#section-42"><i class="fa fa-check"></i><b>12.68</b> </a></li>
<li class="chapter" data-level="12.69" data-path="stan.html"><a href="stan.html#section-43"><i class="fa fa-check"></i><b>12.69</b> </a></li>
<li class="chapter" data-level="12.70" data-path="stan.html"><a href="stan.html#sampling-for-model-linreg-now-chain-3."><i class="fa fa-check"></i><b>12.70</b> SAMPLING FOR MODEL ‘linreg’ NOW (CHAIN 3).</a></li>
<li class="chapter" data-level="12.71" data-path="stan.html"><a href="stan.html#section-44"><i class="fa fa-check"></i><b>12.71</b> </a></li>
<li class="chapter" data-level="12.72" data-path="stan.html"><a href="stan.html#gradient-evaluation-took-0-seconds-2"><i class="fa fa-check"></i><b>12.72</b> Gradient evaluation took 0 seconds</a></li>
<li class="chapter" data-level="12.73" data-path="stan.html"><a href="stan.html#transitions-using-10-leapfrog-steps-per-transition-would-take-0-seconds.-2"><i class="fa fa-check"></i><b>12.73</b> 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</a></li>
<li class="chapter" data-level="12.74" data-path="stan.html"><a href="stan.html#adjust-your-expectations-accordingly-2"><i class="fa fa-check"></i><b>12.74</b> Adjust your expectations accordingly!</a></li>
<li class="chapter" data-level="12.75" data-path="stan.html"><a href="stan.html#section-45"><i class="fa fa-check"></i><b>12.75</b> </a></li>
<li class="chapter" data-level="12.76" data-path="stan.html"><a href="stan.html#section-46"><i class="fa fa-check"></i><b>12.76</b> </a></li>
<li class="chapter" data-level="12.77" data-path="stan.html"><a href="stan.html#iteration-1-2000-0-warmup-2"><i class="fa fa-check"></i><b>12.77</b> Iteration: 1 / 2000 [ 0%] (Warmup)</a></li>
<li class="chapter" data-level="12.78" data-path="stan.html"><a href="stan.html#iteration-200-2000-10-warmup-2"><i class="fa fa-check"></i><b>12.78</b> Iteration: 200 / 2000 [ 10%] (Warmup)</a></li>
<li class="chapter" data-level="12.79" data-path="stan.html"><a href="stan.html#iteration-400-2000-20-warmup-2"><i class="fa fa-check"></i><b>12.79</b> Iteration: 400 / 2000 [ 20%] (Warmup)</a></li>
<li class="chapter" data-level="12.80" data-path="stan.html"><a href="stan.html#iteration-600-2000-30-warmup-2"><i class="fa fa-check"></i><b>12.80</b> Iteration: 600 / 2000 [ 30%] (Warmup)</a></li>
<li class="chapter" data-level="12.81" data-path="stan.html"><a href="stan.html#iteration-800-2000-40-warmup-2"><i class="fa fa-check"></i><b>12.81</b> Iteration: 800 / 2000 [ 40%] (Warmup)</a></li>
<li class="chapter" data-level="12.82" data-path="stan.html"><a href="stan.html#iteration-1000-2000-50-warmup-2"><i class="fa fa-check"></i><b>12.82</b> Iteration: 1000 / 2000 [ 50%] (Warmup)</a></li>
<li class="chapter" data-level="12.83" data-path="stan.html"><a href="stan.html#iteration-1001-2000-50-sampling-2"><i class="fa fa-check"></i><b>12.83</b> Iteration: 1001 / 2000 [ 50%] (Sampling)</a></li>
<li class="chapter" data-level="12.84" data-path="stan.html"><a href="stan.html#iteration-1200-2000-60-sampling-2"><i class="fa fa-check"></i><b>12.84</b> Iteration: 1200 / 2000 [ 60%] (Sampling)</a></li>
<li class="chapter" data-level="12.85" data-path="stan.html"><a href="stan.html#iteration-1400-2000-70-sampling-2"><i class="fa fa-check"></i><b>12.85</b> Iteration: 1400 / 2000 [ 70%] (Sampling)</a></li>
<li class="chapter" data-level="12.86" data-path="stan.html"><a href="stan.html#iteration-1600-2000-80-sampling-2"><i class="fa fa-check"></i><b>12.86</b> Iteration: 1600 / 2000 [ 80%] (Sampling)</a></li>
<li class="chapter" data-level="12.87" data-path="stan.html"><a href="stan.html#iteration-1800-2000-90-sampling-2"><i class="fa fa-check"></i><b>12.87</b> Iteration: 1800 / 2000 [ 90%] (Sampling)</a></li>
<li class="chapter" data-level="12.88" data-path="stan.html"><a href="stan.html#iteration-2000-2000-100-sampling-2"><i class="fa fa-check"></i><b>12.88</b> Iteration: 2000 / 2000 [100%] (Sampling)</a></li>
<li class="chapter" data-level="12.89" data-path="stan.html"><a href="stan.html#section-47"><i class="fa fa-check"></i><b>12.89</b> </a></li>
<li class="chapter" data-level="12.90" data-path="stan.html"><a href="stan.html#elapsed-time-0.078-seconds-warm-up-1"><i class="fa fa-check"></i><b>12.90</b> Elapsed Time: 0.078 seconds (Warm-up)</a></li>
<li class="chapter" data-level="12.91" data-path="stan.html"><a href="stan.html#seconds-sampling-2"><i class="fa fa-check"></i><b>12.91</b> 0.047 seconds (Sampling)</a></li>
<li class="chapter" data-level="12.92" data-path="stan.html"><a href="stan.html#seconds-total-2"><i class="fa fa-check"></i><b>12.92</b> 0.125 seconds (Total)</a></li>
<li class="chapter" data-level="12.93" data-path="stan.html"><a href="stan.html#section-48"><i class="fa fa-check"></i><b>12.93</b> </a></li>
<li class="chapter" data-level="12.94" data-path="stan.html"><a href="stan.html#section-49"><i class="fa fa-check"></i><b>12.94</b> </a></li>
<li class="chapter" data-level="12.95" data-path="stan.html"><a href="stan.html#sampling-for-model-linreg-now-chain-4."><i class="fa fa-check"></i><b>12.95</b> SAMPLING FOR MODEL ‘linreg’ NOW (CHAIN 4).</a></li>
<li class="chapter" data-level="12.96" data-path="stan.html"><a href="stan.html#section-50"><i class="fa fa-check"></i><b>12.96</b> </a></li>
<li class="chapter" data-level="12.97" data-path="stan.html"><a href="stan.html#gradient-evaluation-took-0-seconds-3"><i class="fa fa-check"></i><b>12.97</b> Gradient evaluation took 0 seconds</a></li>
<li class="chapter" data-level="12.98" data-path="stan.html"><a href="stan.html#transitions-using-10-leapfrog-steps-per-transition-would-take-0-seconds.-3"><i class="fa fa-check"></i><b>12.98</b> 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</a></li>
<li class="chapter" data-level="12.99" data-path="stan.html"><a href="stan.html#adjust-your-expectations-accordingly-3"><i class="fa fa-check"></i><b>12.99</b> Adjust your expectations accordingly!</a></li>
<li class="chapter" data-level="12.100" data-path="stan.html"><a href="stan.html#section-51"><i class="fa fa-check"></i><b>12.100</b> </a></li>
<li class="chapter" data-level="12.101" data-path="stan.html"><a href="stan.html#section-52"><i class="fa fa-check"></i><b>12.101</b> </a></li>
<li class="chapter" data-level="12.102" data-path="stan.html"><a href="stan.html#iteration-1-2000-0-warmup-3"><i class="fa fa-check"></i><b>12.102</b> Iteration: 1 / 2000 [ 0%] (Warmup)</a></li>
<li class="chapter" data-level="12.103" data-path="stan.html"><a href="stan.html#iteration-200-2000-10-warmup-3"><i class="fa fa-check"></i><b>12.103</b> Iteration: 200 / 2000 [ 10%] (Warmup)</a></li>
<li class="chapter" data-level="12.104" data-path="stan.html"><a href="stan.html#iteration-400-2000-20-warmup-3"><i class="fa fa-check"></i><b>12.104</b> Iteration: 400 / 2000 [ 20%] (Warmup)</a></li>
<li class="chapter" data-level="12.105" data-path="stan.html"><a href="stan.html#iteration-600-2000-30-warmup-3"><i class="fa fa-check"></i><b>12.105</b> Iteration: 600 / 2000 [ 30%] (Warmup)</a></li>
<li class="chapter" data-level="12.106" data-path="stan.html"><a href="stan.html#iteration-800-2000-40-warmup-3"><i class="fa fa-check"></i><b>12.106</b> Iteration: 800 / 2000 [ 40%] (Warmup)</a></li>
<li class="chapter" data-level="12.107" data-path="stan.html"><a href="stan.html#iteration-1000-2000-50-warmup-3"><i class="fa fa-check"></i><b>12.107</b> Iteration: 1000 / 2000 [ 50%] (Warmup)</a></li>
<li class="chapter" data-level="12.108" data-path="stan.html"><a href="stan.html#iteration-1001-2000-50-sampling-3"><i class="fa fa-check"></i><b>12.108</b> Iteration: 1001 / 2000 [ 50%] (Sampling)</a></li>
<li class="chapter" data-level="12.109" data-path="stan.html"><a href="stan.html#iteration-1200-2000-60-sampling-3"><i class="fa fa-check"></i><b>12.109</b> Iteration: 1200 / 2000 [ 60%] (Sampling)</a></li>
<li class="chapter" data-level="12.110" data-path="stan.html"><a href="stan.html#iteration-1400-2000-70-sampling-3"><i class="fa fa-check"></i><b>12.110</b> Iteration: 1400 / 2000 [ 70%] (Sampling)</a></li>
<li class="chapter" data-level="12.111" data-path="stan.html"><a href="stan.html#iteration-1600-2000-80-sampling-3"><i class="fa fa-check"></i><b>12.111</b> Iteration: 1600 / 2000 [ 80%] (Sampling)</a></li>
<li class="chapter" data-level="12.112" data-path="stan.html"><a href="stan.html#iteration-1800-2000-90-sampling-3"><i class="fa fa-check"></i><b>12.112</b> Iteration: 1800 / 2000 [ 90%] (Sampling)</a></li>
<li class="chapter" data-level="12.113" data-path="stan.html"><a href="stan.html#iteration-2000-2000-100-sampling-3"><i class="fa fa-check"></i><b>12.113</b> Iteration: 2000 / 2000 [100%] (Sampling)</a></li>
<li class="chapter" data-level="12.114" data-path="stan.html"><a href="stan.html#section-53"><i class="fa fa-check"></i><b>12.114</b> </a></li>
<li class="chapter" data-level="12.115" data-path="stan.html"><a href="stan.html#elapsed-time-0.067-seconds-warm-up"><i class="fa fa-check"></i><b>12.115</b> Elapsed Time: 0.067 seconds (Warm-up)</a></li>
<li class="chapter" data-level="12.116" data-path="stan.html"><a href="stan.html#seconds-sampling-3"><i class="fa fa-check"></i><b>12.116</b> 0.039 seconds (Sampling)</a></li>
<li class="chapter" data-level="12.117" data-path="stan.html"><a href="stan.html#seconds-total-3"><i class="fa fa-check"></i><b>12.117</b> 0.106 seconds (Total)</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#further-reading-7"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i><b>13</b> Ridge regression</a><ul>
<li class="chapter" data-level="13.1" data-path="ridge.html"><a href="ridge.html#introduction-3"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sem.html"><a href="sem.html"><i class="fa fa-check"></i><b>14</b> Structural equation model</a><ul>
<li class="chapter" data-level="14.1" data-path="sem.html"><a href="sem.html#introduction-4"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
</ul></li>
<li class="part"><span><b>III ECOLOGICAL MODELS</b></span></li>
<li class="chapter" data-level="15" data-path="PART-III.html"><a href="PART-III.html"><i class="fa fa-check"></i><b>15</b> Introduction to PART III</a><ul>
<li class="chapter" data-level="15.1" data-path="PART-III.html"><a href="PART-III.html#model-notations"><i class="fa fa-check"></i><b>15.1</b> Model notations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html"><i class="fa fa-check"></i><b>16</b> Zero-inflated Poisson Mixed Model</a><ul>
<li class="chapter" data-level="16.1" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#introduction-5"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#example-data"><i class="fa fa-check"></i><b>16.2</b> Example data</a></li>
<li class="chapter" data-level="16.3" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#model"><i class="fa fa-check"></i><b>16.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cjs-with-mix.html"><a href="cjs-with-mix.html"><i class="fa fa-check"></i><b>17</b> Fränzi Modell</a><ul>
<li class="chapter" data-level="17.1" data-path="cjs-with-mix.html"><a href="cjs-with-mix.html#introduction-6"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
<li class="divider"></li>
</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Ecology with R and Stan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rgis" class="section level1">
<h1><span class="header-section-number">7</span> Spatial analyses and maps</h1>
<ul>
<li>Almost all the things that we can do with traditional geographic information system we can also do within R.</li>
<li>If we do it in R we get the useful benefits of a script approach that allows for reproducible analyses (see Chapter <a href="reproducible.html#reproducible">8</a>) and that can be scaled to many more objects or larger data sets.</li>
<li>Here we simply introduce the packages and functions that we most often use when working with spatial data.</li>
</ul>
<div id="data-types" class="section level2">
<h2><span class="header-section-number">7.1</span> Data types</h2>
<div id="rasterdata" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Raster data</h3>
<p>Very broadly speaking, we divide spatial data into two categories, raster data and all other types of data for points, lines or polygons. Raster data consists of a grid (i.e. a matrix) where each cell of the grid contains one or several values representing the spatial information. The R-package <code>raster</code> is very efficient for raster data.</p>
<p>We can use the function <code>raster()</code> to load raster data from files. Most of the common file formats for raster data such as .geotiff, .tif or .grd are supported. However, raster data can also be converted from tables with one column for the x-coordinates, one column for the y-coordinates and one column for the spatial information. The coordinates must be from a regular grid. For example the freely available <a href="https://www.bfs.admin.ch/bfs/de/home/dienstleistungen/geostat/geodaten-bundesstatistik/topografie.html">topographic data of Switzerland</a> are collected on a 100m x 100m grid. In the following example the tibble <code>elevations</code> contains the elevation data from the canton of Aargau and is converted into raster data using the function <code>rasterFromXYZ()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)
ra &lt;-<span class="st"> </span><span class="kw">rasterFromXYZ</span>(elevation)
<span class="kw">plot</span>(ra)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-3"></span>
<img src="06-rgis_files/figure-html/unnamed-chunk-3-1.png" alt="Meter above sea leavel (m) accross the canton Aargau in Switzerland." width="768" />
<p class="caption">
Figure 7.1: Meter above sea leavel (m) accross the canton Aargau in Switzerland.
</p>
</div>
</div>
<div id="geometrydata" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Geometry data</h3>
<p>All geometry data types are composed of points. The spatial location of a point is defined by its x and y coordinates. Using several points one can then define lines (sequence of points connected by straight lines) and polygons (sequence of points that form a closed ring). Points, lines and plygons are the geometries we usually work with. We use the package <code>sf</code> to work with geometry data types. Its functions are very efficient to work with all spatial data other than raster data. It also links to GDAL (i.e. a computer software library for reading and writing raster and vector geospatial data formats) and proj.4 (i.e. a library for performing conversions between cartographic projections), which are important tools when woring with different sources of spatial data.</p>
<p>We can used the function <code>st_read()</code> to read geometry data from file or database. In the following example, however, we convert the tibble <code>frogs</code> into a simple feature collection. The data file <code>frogs</code>, formatted as a tibble, contains different columns including the counts, variables that describe the ponds as well as the spatial coordinates of the counts. The simple feature collection looks rather similar to the original tibble, however instead of the x and y colomns it now contains the column geometry. With the simple feature collection we can work pretty much in the same way as we use to work with tibbles. For example we can filter only the data from 2011, select the geometries and plot them on the top of the raster with the elevation across the entire canton of Aargau (see <a href="rgis.html#rasterdata">7.1.1</a> for the raster data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
dat &lt;-<span class="st"> </span>frogs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="dt">crs =</span> <span class="dv">21781</span>)
<span class="kw">plot</span>(ra)
dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2011</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_geometry</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">pch =</span> <span class="st">&quot;x&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<img src="06-rgis_files/figure-html/unnamed-chunk-4-1.png" alt="Locations of the ponds where frogs were counted in 2011. The background image shows the elevation (meter above sea level)." width="768" />
<p class="caption">
Figure 7.2: Locations of the ponds where frogs were counted in 2011. The background image shows the elevation (meter above sea level).
</p>
</div>
</div>
</div>
<div id="basic-functions" class="section level2">
<h2><span class="header-section-number">7.2</span> Basic functions</h2>
<p>In this chapter we shortly describe some functions that we often use when working with spatial data in R.</p>
<div id="coordinate-systems" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Coordinate systems</h3>
<p>An important aspect of spatial data is the coordinate reference system (CRS). A CRS determines for instance where the center of the map is, the units for the coordinates and others. <a href="https://proj4.org/#">PROJ.4</a> is an open source software library that is commonly used for CRS transformation. Most commonly used CRSs have been assigned a HERE IS SOMETHING MISSING. The EPSG (European Petroleum Survey Group) code is a unique ID that can be used to identify a CRS. Thus if we know the EPSG code it is rather simple to transform spatial data into other CRS. To search for the correct EPSG code we can use <a href="https://www.epsg-registry.org" class="uri">https://www.epsg-registry.org</a> or <a href="http://www.spatialreference.org" class="uri">http://www.spatialreference.org</a></p>
<p>The following code shows how to assign the CRS of existing data and how to transform the coordinate system for raster data and sf data, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assign CRS for raster data</span>
<span class="kw">crs</span>(ra) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:21781&quot;</span>)

<span class="co"># Assign CRS for sf data</span>
<span class="kw">st_crs</span>(dat) &lt;-<span class="st"> </span><span class="dv">21781</span>

<span class="co"># Transfrom raster data to WGS84</span>
<span class="kw">projectRaster</span>(ra, <span class="dt">crs =</span> <span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:4326&quot;</span>))

<span class="co"># Transfrom sf data to WGS84</span>
<span class="kw">st_transform</span>(dat, <span class="dt">crs =</span> <span class="dv">4326</span>)</code></pre></div>
</div>
<div id="joining-spatial-data" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Joining spatial data</h3>
<p>Joining two non-spatial datasets relies on a shared variable (<code>key</code>) using for instance the function <code>left_join()</code>, as described in chapter <a href="#joindata"><strong>??</strong></a>. In a spatial context, we apply the exact same concept except for the key being a shared areas of geographic space. Note, however, that people with a background in geographic information systems may call these operations differently, such as spatial overlay or intersection.</p>
<p>For <a href="rgis.html#geometrydata">geometry data</a> we can use the function <code>st_join()</code>. As an example, we aim to add the <a href="biogeographische%20regionen%20der%20schweiz">biogegraphic Region</a> to the counts of the number of frogs in ponds of the Canton Aargau. We transform the <code>frogs</code> data into a spatial object (i.e. a simple feature collection). The polygons of the biogegraphic regions in Switzerland are available in the object <code>bgr</code>. To each of the polygons additional data are available and we aim to extract the information from the column <code>BIOGREG_R6</code>, which contains the name of the biogeographic region. We add this column to the frogs data using the function <code>st_join()</code> as following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;RData/bgr.RData&quot;</span>)
dat &lt;-<span class="st"> </span>frogs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="dt">crs =</span> <span class="dv">21781</span>)
dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_join</span>(bgr[<span class="st">&quot;BIOGREG_R6&quot;</span>])</code></pre></div>
</div>
</div>
<div id="further-reading-4" class="section level2">
<h2><span class="header-section-number">7.3</span> Further reading</h2>
<ul>
<li><p><a href="https://geocompr.robinlovelace.net">Geocomputation with R</a>: This online-book is aimed at people who want to do spatial data analysis, visualization and modeling using open source software and reproducible workflows.</p></li>
<li><p><a href="http://rspatial.org/index.html">Spatial Data Analysis and Modeling with R</a>: Online introduction to do spatial analyses with R. Good introduction to coordinate systems and projections.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproducible.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TobiasRoth/BDAEcology/edit/master/06-rgis.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
