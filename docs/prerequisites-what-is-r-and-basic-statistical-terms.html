<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Analysis in Ecology with R and Stan</title>
  <meta name="description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Data Analysis in Ecology with R and Stan" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.jpg" />
  <meta property="og:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="github-repo" content="TobiasRoth/BDAEcology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Analysis in Ecology with R and Stan" />
  
  <meta name="twitter:description" content="This GitHub-book is collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="twitter:image" content="images/cover.jpg" />

<meta name="author" content="Fränzi Korner-Nievergelt and Tobias Roth">


<meta name="date" content="2018-09-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="PART-I.html">
<link rel="next" href="analyses-steps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="Settings/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I R FOR ECOLOGISTS</b></span></li>
<li class="chapter" data-level="1" data-path="PART-I.html"><a href="PART-I.html"><i class="fa fa-check"></i><b>1</b> Introduction to PART I</a><ul>
<li class="chapter" data-level="1.1" data-path="PART-I.html"><a href="PART-I.html#further-reading"><i class="fa fa-check"></i><b>1.1</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html"><i class="fa fa-check"></i><b>2</b> Prerequisites: What is R and basic statistical terms</a><ul>
<li class="chapter" data-level="2.1" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#why-using-r"><i class="fa fa-check"></i><b>2.2</b> Why using R?</a></li>
<li class="chapter" data-level="2.3" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#working-with-r"><i class="fa fa-check"></i><b>2.3</b> Working with R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#console-and-editor"><i class="fa fa-check"></i><b>2.3.1</b> Console and Editor</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#scale-of-measurement"><i class="fa fa-check"></i><b>2.4</b> Scale of measurement</a></li>
<li class="chapter" data-level="2.5" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#correlations"><i class="fa fa-check"></i><b>2.5</b> Correlations</a><ul>
<li class="chapter" data-level="2.5.1" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#basics"><i class="fa fa-check"></i><b>2.5.1</b> Basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>2.5.2</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="2.5.3" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#spearman-correlation-coefficient"><i class="fa fa-check"></i><b>2.5.3</b> Spearman correlation coefficient</a></li>
<li class="chapter" data-level="2.5.4" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#kendalls-tau"><i class="fa fa-check"></i><b>2.5.4</b> Kendall’s tau</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#principal-components-analyses-pca"><i class="fa fa-check"></i><b>2.6</b> Principal components analyses PCA</a></li>
<li class="chapter" data-level="2.7" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#inferential-statistics"><i class="fa fa-check"></i><b>2.7</b> Inferential statistics</a></li>
<li class="chapter" data-level="2.8" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#central-limit-theorem-law-of-large-numbers"><i class="fa fa-check"></i><b>2.8</b> Central limit theorem / law of large numbers</a></li>
<li class="chapter" data-level="2.9" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#bayes-theorem"><i class="fa fa-check"></i><b>2.9</b> Bayes theorem</a></li>
<li class="chapter" data-level="2.10" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#bayes-theorem-for-continuous-parameters"><i class="fa fa-check"></i><b>2.10</b> Bayes theorem for continuous parameters</a><ul>
<li class="chapter" data-level="2.10.1" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#single-parameter-model"><i class="fa fa-check"></i><b>2.10.1</b> Single parameter model</a></li>
<li class="chapter" data-level="2.10.2" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#a-model-with-two-parameters"><i class="fa fa-check"></i><b>2.10.2</b> A model with two parameters</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="prerequisites-what-is-r-and-basic-statistical-terms.html"><a href="prerequisites-what-is-r-and-basic-statistical-terms.html#t-distribution"><i class="fa fa-check"></i><b>2.11</b> t-distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyses-steps.html"><a href="analyses-steps.html"><i class="fa fa-check"></i><b>3</b> Data analysis step by step</a><ul>
<li class="chapter" data-level="3.1" data-path="analyses-steps.html"><a href="analyses-steps.html#step1"><i class="fa fa-check"></i><b>3.1</b> Plausibility of Data</a></li>
<li class="chapter" data-level="3.2" data-path="analyses-steps.html"><a href="analyses-steps.html#step2"><i class="fa fa-check"></i><b>3.2</b> Relationships</a></li>
<li class="chapter" data-level="3.3" data-path="analyses-steps.html"><a href="analyses-steps.html#step3"><i class="fa fa-check"></i><b>3.3</b> Error Distribution</a></li>
<li class="chapter" data-level="3.4" data-path="analyses-steps.html"><a href="analyses-steps.html#step4"><i class="fa fa-check"></i><b>3.4</b> Preparation of Explanatory Variables</a></li>
<li class="chapter" data-level="3.5" data-path="analyses-steps.html"><a href="analyses-steps.html#step5"><i class="fa fa-check"></i><b>3.5</b> Data Structure</a></li>
<li class="chapter" data-level="3.6" data-path="analyses-steps.html"><a href="analyses-steps.html#step6"><i class="fa fa-check"></i><b>3.6</b> Fit the Model</a></li>
<li class="chapter" data-level="3.7" data-path="analyses-steps.html"><a href="analyses-steps.html#step7"><i class="fa fa-check"></i><b>3.7</b> Check Model</a></li>
<li class="chapter" data-level="3.8" data-path="analyses-steps.html"><a href="analyses-steps.html#step8"><i class="fa fa-check"></i><b>3.8</b> Model Uncertainty</a></li>
<li class="chapter" data-level="3.9" data-path="analyses-steps.html"><a href="analyses-steps.html#step9"><i class="fa fa-check"></i><b>3.9</b> Draw Conclusions</a></li>
<li class="chapter" data-level="" data-path="analyses-steps.html"><a href="analyses-steps.html#further-reading-1"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datamanip.html"><a href="datamanip.html"><i class="fa fa-check"></i><b>4</b> Data preparation</a><ul>
<li class="chapter" data-level="4.1" data-path="datamanip.html"><a href="datamanip.html#basic-operations"><i class="fa fa-check"></i><b>4.1</b> Basic operations</a></li>
<li class="chapter" data-level="4.2" data-path="datamanip.html"><a href="datamanip.html#further-reading-2"><i class="fa fa-check"></i><b>4.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>5</b> Visualizations</a><ul>
<li class="chapter" data-level="5.1" data-path="figures.html"><a href="figures.html#short-checklist-for-figures"><i class="fa fa-check"></i><b>5.1</b> Short Checklist for figures</a></li>
<li class="chapter" data-level="" data-path="figures.html"><a href="figures.html#further-reading-3"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>6</b> Probability distributions</a><ul>
<li class="chapter" data-level="6.1" data-path="distributions.html"><a href="distributions.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.2</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3" data-path="distributions.html"><a href="distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="6.4" data-path="distributions.html"><a href="distributions.html#gamma-distribution"><i class="fa fa-check"></i><b>6.4</b> Gamma distribution</a><ul>
<li class="chapter" data-level="6.4.1" data-path="distributions.html"><a href="distributions.html#cauchydistri"><i class="fa fa-check"></i><b>6.4.1</b> Cauchy distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rgis.html"><a href="rgis.html"><i class="fa fa-check"></i><b>7</b> Spatial analyses and maps</a><ul>
<li class="chapter" data-level="7.1" data-path="rgis.html"><a href="rgis.html#data-types"><i class="fa fa-check"></i><b>7.1</b> Data types</a><ul>
<li class="chapter" data-level="7.1.1" data-path="rgis.html"><a href="rgis.html#rasterdata"><i class="fa fa-check"></i><b>7.1.1</b> Raster data</a></li>
<li class="chapter" data-level="7.1.2" data-path="rgis.html"><a href="rgis.html#geometry-data-types"><i class="fa fa-check"></i><b>7.1.2</b> Geometry data types</a></li>
<li class="chapter" data-level="7.1.3" data-path="rgis.html"><a href="rgis.html#basic-function"><i class="fa fa-check"></i><b>7.1.3</b> Basic function</a></li>
<li class="chapter" data-level="7.1.4" data-path="rgis.html"><a href="rgis.html#coordinate-systems"><i class="fa fa-check"></i><b>7.1.4</b> Coordinate systems</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rgis.html"><a href="rgis.html#further-reading-4"><i class="fa fa-check"></i><b>7.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reproducible.html"><a href="reproducible.html"><i class="fa fa-check"></i><b>8</b> Reproducible Research</a><ul>
<li class="chapter" data-level="8.1" data-path="reproducible.html"><a href="reproducible.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="reproducible.html"><a href="reproducible.html#further-reading-5"><i class="fa fa-check"></i><b>8.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="furthertopics.html"><a href="furthertopics.html"><i class="fa fa-check"></i><b>9</b> Further topics</a><ul>
<li class="chapter" data-level="9.1" data-path="furthertopics.html"><a href="furthertopics.html#bioacoustic-analyse"><i class="fa fa-check"></i><b>9.1</b> Bioacoustic analyse</a></li>
<li class="chapter" data-level="9.2" data-path="furthertopics.html"><a href="furthertopics.html#python"><i class="fa fa-check"></i><b>9.2</b> Python</a></li>
</ul></li>
<li class="part"><span><b>II BAYESIAN DATA ANALYSIS</b></span></li>
<li class="chapter" data-level="10" data-path="PART-II.html"><a href="PART-II.html"><i class="fa fa-check"></i><b>10</b> Introduction to PART II</a><ul>
<li class="chapter" data-level="" data-path="PART-II.html"><a href="PART-II.html#further-reading-6"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>11</b> Prior distributions</a><ul>
<li class="chapter" data-level="11.1" data-path="priors.html"><a href="priors.html#introduction-2"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="priors.html"><a href="priors.html#choosepriors"><i class="fa fa-check"></i><b>11.2</b> How to choose a prior</a></li>
<li class="chapter" data-level="11.3" data-path="priors.html"><a href="priors.html#prior-sensitivity"><i class="fa fa-check"></i><b>11.3</b> Prior sensitivity</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>12</b> MCMC using Stan</a><ul>
<li class="chapter" data-level="12.1" data-path="stan.html"><a href="stan.html#background"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="stan.html"><a href="stan.html#install-rstan"><i class="fa fa-check"></i><b>12.2</b> Install <code>rstan</code></a></li>
<li class="chapter" data-level="12.3" data-path="stan.html"><a href="stan.html#firststanmod"><i class="fa fa-check"></i><b>12.3</b> Writing a Stan model</a></li>
<li class="chapter" data-level="12.4" data-path="stan.html"><a href="stan.html#run-stan-from-r"><i class="fa fa-check"></i><b>12.4</b> Run Stan from R</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#further-reading-7"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i><b>13</b> Ridge regression</a><ul>
<li class="chapter" data-level="13.1" data-path="ridge.html"><a href="ridge.html#introduction-3"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sem.html"><a href="sem.html"><i class="fa fa-check"></i><b>14</b> Structural equation model</a><ul>
<li class="chapter" data-level="14.1" data-path="sem.html"><a href="sem.html#introduction-4"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
</ul></li>
<li class="part"><span><b>III ECOLOGICAL MODELS</b></span></li>
<li class="chapter" data-level="15" data-path="PART-III.html"><a href="PART-III.html"><i class="fa fa-check"></i><b>15</b> Introduction to PART III</a><ul>
<li class="chapter" data-level="15.1" data-path="PART-III.html"><a href="PART-III.html#model-notations"><i class="fa fa-check"></i><b>15.1</b> Model notations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html"><i class="fa fa-check"></i><b>16</b> Zero-inflated Poisson Mixed Model</a><ul>
<li class="chapter" data-level="16.1" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#introduction-5"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#example-data"><i class="fa fa-check"></i><b>16.2</b> Example data</a></li>
<li class="chapter" data-level="16.3" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#model"><i class="fa fa-check"></i><b>16.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cjs-with-mix.html"><a href="cjs-with-mix.html"><i class="fa fa-check"></i><b>17</b> Fränzi Modell</a><ul>
<li class="chapter" data-level="17.1" data-path="cjs-with-mix.html"><a href="cjs-with-mix.html#introduction-6"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
<li class="divider"></li>
</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Ecology with R and Stan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prerequisites-what-is-r-and-basic-statistical-terms" class="section level1">
<h1><span class="header-section-number">2</span> Prerequisites: What is R and basic statistical terms</h1>
<div id="what-is-r" class="section level2">
<h2><span class="header-section-number">2.1</span> What is R?</h2>
<ul>
<li>download for free: www.r-project.org</li>
<li>authors of first version: Robert Gentleman and Ross Ihaka, University of Auckland</li>
<li>since 1997: R development core team</li>
<li>R is a programming language</li>
</ul>
</div>
<div id="why-using-r" class="section level2">
<h2><span class="header-section-number">2.2</span> Why using R?</h2>
<ul>
<li>we program the statistical analyses</li>
<li>we have to know what we do (no clicking)</li>
<li>analyses are documented and reproducible</li>
<li>we can write own functions</li>
<li>methods can be shared (CRAN)</li>
</ul>
<p>R is easy to learn (intuitive), less strict syntax, slow<br />
e.g. compared to Python or Julia</p>
</div>
<div id="working-with-r" class="section level2">
<h2><span class="header-section-number">2.3</span> Working with R</h2>
<div id="console-and-editor" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Console and Editor</h3>
<p>R Console and Editor (mostly RStudio)</p>

</div>
</div>
<div id="scale-of-measurement" class="section level2">
<h2><span class="header-section-number">2.4</span> Scale of measurement</h2>
<table style="width:99%;">
<colgroup>
<col width="12%" />
<col width="27%" />
<col width="27%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Scale</th>
<th align="left">Examples</th>
<th align="left">Properties</th>
<th align="left">Coding in R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nominal</td>
<td align="left">Sex, genotype, habitat</td>
<td align="left">Identity (values have a unique meaning)</td>
<td align="left"><code>factor()</code></td>
</tr>
<tr class="even">
<td align="left">Ordinal</td>
<td align="left">Elevational zones</td>
<td align="left">Identity and magnitude (values have an ordered relationship)</td>
<td align="left"><code>ordered()</code></td>
</tr>
<tr class="odd">
<td align="left">Numeric</td>
<td align="left">Discrete: counts; continuous: body weight, wing length</td>
<td align="left">Identity, magnitude, and equal intervals</td>
<td align="left"><code>intgeger()</code> <code>numeric()</code></td>
</tr>
</tbody>
</table>
</div>
<div id="correlations" class="section level2">
<h2><span class="header-section-number">2.5</span> Correlations</h2>
<div id="basics" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Basics</h3>
<ul>
<li><p>variance <span class="math inline">\(\hat{\sigma^2} = s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i-\bar{x})^2\)</span></p></li>
<li><p>standard deviation <span class="math inline">\(\hat{\sigma} = s = \sqrt{s^2}\)</span></p></li>
<li><p>covariance <span class="math inline">\(q = \frac{1}{n-1}\sum_{i=1}^{n}((x_i-\bar{x})*(y_i-\bar{y}))\)</span></p></li>
</ul>
</div>
<div id="pearson-correlation-coefficient" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Pearson correlation coefficient</h3>
<p>standardized covariance</p>
<p><span class="math inline">\(r=\frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i-\bar{x})^2\sum_{i=1}^{n}(y_i-\bar{y})^2}}\)</span></p>
</div>
<div id="spearman-correlation-coefficient" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Spearman correlation coefficient</h3>
<p>rank correlation<br />
correlation between rank(x) and rank(y)</p>
<p>robust against outliers</p>
</div>
<div id="kendalls-tau" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Kendall’s tau</h3>
<p>rank correlation</p>
<p>I = number of pairs (i,k) for which <span class="math inline">\((x_i &lt; x_k)\)</span> &amp; <span class="math inline">\((y_i &gt; y_k)\)</span> or viceversa<br />
<span class="math inline">\(\tau = 1-\frac{4I}{(n(n-1))}\)</span></p>
</div>
</div>
<div id="principal-components-analyses-pca" class="section level2">
<h2><span class="header-section-number">2.6</span> Principal components analyses PCA</h2>
<p>rotation of the coordinate system</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">1</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="fl">0.8</span><span class="op">*</span>x, <span class="dv">1</span>)
pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="kw">cbind</span>(x,y), <span class="dt">cor=</span><span class="ot">TRUE</span>)
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>))
<span class="kw">plot</span>(x<span class="op">-</span><span class="kw">mean</span>(x),y<span class="op">-</span><span class="kw">mean</span>(y), <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
pc1 &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(<span class="kw">cbind</span>(x,y)))<span class="op">$</span>vectors[,<span class="dv">1</span>]
pc2 &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(<span class="kw">cbind</span>(x,y)))<span class="op">$</span>vectors[,<span class="dv">2</span>]
<span class="kw">abline</span>(<span class="dv">0</span>, pc1[<span class="dv">2</span>]<span class="op">/</span>pc1[<span class="dv">1</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, pc2[<span class="dv">2</span>]<span class="op">/</span>pc2[<span class="dv">1</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-2"></span>
<img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-2-1.png" alt="Principal components are eigenvectors of the covariance or correlation matrix" width="768" />
<p class="caption">
Figure 2.1: Principal components are eigenvectors of the covariance or correlation matrix
</p>
</div>
<p>rotation of the coordinate system so that</p>
<ul>
<li>first component explains most variance<br />
</li>
<li>second component explains most of the remaining variance and is perpendicular to the first one<br />
</li>
<li>third component explains most of the remaining variance and is perpendicular to the first two<br />
</li>
<li>…</li>
</ul>
<p><span class="math inline">\((x,y)\)</span> becomes <span class="math inline">\((pc1, pc2)\)</span><br />
where<br />
<span class="math inline">\(pc1_i= b_{11} x_i + b_{12} y_i\)</span><br />
<span class="math inline">\(pc2_i = b_{21} x_i + b_{22} y_i\)</span> with <span class="math inline">\(b_{jk}\)</span> being loadings</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="kw">cbind</span>(x,y), <span class="dt">cor=</span><span class="ot">TRUE</span>)
<span class="kw">loadings</span>(pca)</code></pre></div>
<pre><code>## 
## Loadings:
##   Comp.1 Comp.2
## x  0.707  0.707
## y  0.707 -0.707
## 
##                Comp.1 Comp.2
## SS loadings       1.0    1.0
## Proportion Var    0.5    0.5
## Cumulative Var    0.5    1.0</code></pre>
<p>loadings of a component can be multiplied by -1</p>
<p>proportion of variance explained by each component<br />
number of components = number of variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(pca)</code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1    Comp.2
## Standard deviation     1.3023938 0.5511537
## Proportion of Variance 0.8481148 0.1518852
## Cumulative Proportion  0.8481148 1.0000000</code></pre>
<p>outlook: components with low variance are shrinked to a higher degree in Ridge regression</p>
</div>
<div id="inferential-statistics" class="section level2">
<h2><span class="header-section-number">2.7</span> Inferential statistics</h2>

<p><a href="https://peerj.com/preprints/26857" class="uri">https://peerj.com/preprints/26857</a></p>
<blockquote>
<p>there is never a “yes-or-no” answer<br />
there will always be uncertainty<br />
Amrhein (2017)</p>
</blockquote>
<p>Statistical analyses is quantifying uncertainty.</p>
<p>Quantification of uncertainty only possible if</p>
<ol style="list-style-type: decimal">
<li>the mechanisms under study are known</li>
<li>the observations are a random sample from the population of interest</li>
</ol>
<p>Solutions:</p>
<ol style="list-style-type: decimal">
<li>working with models and reporting assumptions<br />
</li>
<li>study design</li>
</ol>
<blockquote>
<p>reported uncertainties always are too small!</p>
</blockquote>
<p>Example: Number of stats courses before starting a PhD among all PhD students</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate the virtual true data</span>
<span class="kw">set.seed</span>(<span class="dv">235325</span>)   <span class="co"># set seed for random number generator</span>

<span class="co"># simulate fake data of the whole population</span>
statscourses &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">300000</span>, <span class="kw">rgamma</span>(<span class="dv">300000</span>, <span class="dv">2</span>, <span class="dv">3</span>))  

<span class="co"># draw a random sample from the population</span>
n &lt;-<span class="st"> </span><span class="dv">12</span>            <span class="co"># sample size</span>
y &lt;-<span class="st"> </span><span class="kw">sample</span>(statscourses, <span class="dv">12</span>, <span class="dt">replace=</span><span class="ot">FALSE</span>)         </code></pre></div>
<p><img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>We observe the sample mean, what do we know about the population mean?</p>
<p>Frequentist solution: How would the sample mean scatter, if we repeat the study many times?</p>
<p>Bayesian solution: For any possible value, what is the probability that it is the true population mean?</p>
<p><img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>Standard deviation and standard error<br />
<img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<p>SE = SD/sqrt(n)</p>
<p>SE = SD of posterior distribution</p>
</div>
<div id="central-limit-theorem-law-of-large-numbers" class="section level2">
<h2><span class="header-section-number">2.8</span> Central limit theorem / law of large numbers</h2>
<p><img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<p>normal distribution = Gaussian distribution</p>
<p><span class="math inline">\(p(\theta) = \frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{1}{2\sigma^2}(\theta -\mu)^2)\)</span></p>
<p><span class="math inline">\(E(\theta) = \mu\)</span>, <span class="math inline">\(var(\theta) = \sigma^2\)</span>, <span class="math inline">\(mode(\theta) = \mu\)</span></p>
<p><img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
</div>
<div id="bayes-theorem" class="section level2">
<h2><span class="header-section-number">2.9</span> Bayes theorem</h2>
<p><span class="math inline">\(P(A|B) = \frac{P(B|A)P(A)}{P(B)}\)</span></p>
<table>
<thead>
<tr class="header">
<th align="left">sex</th>
<th align="left">flowers</th>
<th align="left">wine</th>
<th align="left"><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left"><strong>3</strong></td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left"><strong>4</strong></td>
</tr>
<tr class="odd">
<td align="left">——-</td>
<td align="left">—————-</td>
<td align="left">—————-</td>
<td align="left">——————-</td>
</tr>
<tr class="even">
<td align="left"><strong>sum</strong></td>
<td align="left"><strong>4</strong></td>
<td align="left"><strong>3</strong></td>
<td align="left"><strong>7</strong></td>
</tr>
</tbody>
</table>
<p>What is the probability that the person likes wine given it is a female?<br />
<span class="math inline">\(P(A) =\)</span> likes wine <span class="math inline">\(= 0.43\)</span><br />
<span class="math inline">\(P(B) =\)</span> female <span class="math inline">\(= 0.43\)</span></p>
<p><span class="math inline">\(P(B|A) =\)</span> proportion of females among the wine liker <span class="math inline">\(= 0.33\)</span></p>
<p>Knowing the person’s sex increases the knowledge of the birthday preference.</p>
</div>
<div id="bayes-theorem-for-continuous-parameters" class="section level2">
<h2><span class="header-section-number">2.10</span> Bayes theorem for continuous parameters</h2>
<p><span class="math inline">\(p(\theta|y) = \frac{p(y|\theta)p(\theta)}{p(y)} = \frac{p(y|\theta)p(\theta)}{\int p(y|\theta)p(\theta) d\theta}\)</span></p>
<p><span class="math inline">\(p(\theta|y)\)</span>: posterior distribution</p>
<p><span class="math inline">\(p(y|\theta)\)</span>: likelihood, data model</p>
<p><span class="math inline">\(p(\theta)\)</span>: prior distribution</p>
<p><span class="math inline">\(p(y)\)</span>: scaling constant</p>
<div id="single-parameter-model" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Single parameter model</h3>
<p><span class="math inline">\(p(y|\theta) = Norm(\theta, \sigma)\)</span>, with <span class="math inline">\(\sigma\)</span> known</p>
<p><span class="math inline">\(p(\theta) = Norm(\mu_0, \tau_0)\)</span></p>
<p><span class="math inline">\(p(\theta|y) = Norm(\mu_n, \tau_n)\)</span>, where <span class="math inline">\(\mu_n= \frac{\frac{1}{\tau_0^2}\mu_0 + \frac{n}{\sigma^2}\bar{y}}{\frac{1}{\tau_0^2}+\frac{n}{\sigma^2}}\)</span> and <span class="math inline">\(\frac{1}{\tau_n^2} = \frac{1}{\tau_0^2} + \frac{n}{\sigma^2}\)</span></p>
<p><span class="math inline">\(\bar{y}\)</span> is a sufficient statistics<br />
<span class="math inline">\(p(\theta) = Norm(\mu_0, \tau_0)\)</span> is a conjugate prior for <span class="math inline">\(p(y|\theta) = Norm(\theta, \sigma)\)</span>, with <span class="math inline">\(\sigma\)</span> known.</p>
<p>Posterior mean = weighted average between prior mean and <span class="math inline">\(\bar{y}\)</span> with weights equal to the precisions (<span class="math inline">\(\frac{1}{\tau_0^2}\)</span> and <span class="math inline">\(\frac{n}{\sigma^2}\)</span>) <img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
</div>
<div id="a-model-with-two-parameters" class="section level3">
<h3><span class="header-section-number">2.10.2</span> A model with two parameters</h3>
<p><span class="math inline">\(p(y|\theta, \sigma) = Norm(\theta, \sigma)\)</span></p>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># weight (g)</span>
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">47.5</span>, <span class="dv">43</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="fl">48.5</span>, <span class="fl">37.5</span>, <span class="fl">41.5</span>, <span class="fl">45.5</span>)
n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</code></pre></div>
<p><span class="math inline">\(p(y|\theta, \sigma) = Norm(\theta, \sigma)\)</span></p>
<p><span class="math inline">\(p(\theta, \sigma) = N-Inv-\chi^2(\mu_0, \sigma_0^2/\kappa_0; v_0, \sigma_0^2)\)</span> conjugate prior</p>
<p><span class="math inline">\(p(\theta,\sigma|y) = \frac{p(y|\theta, \sigma)p(\theta, \sigma)}{p(y)} = N-Inv-\chi^2(\mu_n, \sigma_n^2/\kappa_n; v_n, \sigma_n^2)\)</span>, with</p>
<p><span class="math inline">\(\mu_n= \frac{\kappa_0}{\kappa_0+n}\mu_0 + \frac{n}{\kappa_0+n}\bar{y}\)</span></p>
<p><span class="math inline">\(\kappa_n = \kappa_0+n\)</span></p>
<p><span class="math inline">\(v_n = v_0 +n\)</span></p>
<p><span class="math inline">\(v_n\sigma_n^2=v_0\sigma_0^2+(n-1)s^2+\frac{\kappa_0n}{\kappa_0+n}(\bar{y}-\mu_0)^2\)</span></p>
<p><span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(s^2\)</span> are sufficient statistics</p>
<p>Joint, marginal and conditional posterior distributions <img src="02-aa-prerequisites_files/figure-html/unnamed-chunk-14-1.png" width="768" /></p>
</div>
</div>
<div id="t-distribution" class="section level2">
<h2><span class="header-section-number">2.11</span> t-distribution</h2>
<p>marginal posterior distribution of a normal mean with unknown variance and conjugate prior distribution</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="PART-I.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyses-steps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TobiasRoth/BDAEcology/edit/master/02-aa-prerequisites.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
